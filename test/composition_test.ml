open! Base
open! Stdio
open Combinat

let print c = print_s @@ [%sexp_of: Int_array.t] c

let%expect_test "compositions" =
  compositions ~k:1 ~n:7 print;
  [%expect {| (7) |}]

let%expect_test "compositions" =
  compositions ~k:4 ~n:7 print;
  [%expect
    {|
       (1 1 1 4)
       (1 1 2 3)
       (1 2 1 3)
       (2 1 1 3)
       (1 1 3 2)
       (1 2 2 2)
       (2 1 2 2)
       (1 3 1 2)
       (2 2 1 2)
       (3 1 1 2)
       (1 1 4 1)
       (1 2 3 1)
       (2 1 3 1)
       (1 3 2 1)
       (2 2 2 1)
       (3 1 2 1)
       (1 4 1 1)
       (2 3 1 1)
       (4 1 1 1) |}]

let%expect_test "compositions-2" =
  for n = 2 to 8 do
    compositions ~k:2 ~n print;
    [%expect
      {|
         (* CR expect_test: Collector ran multiple times with different outputs *)
         =========================================================================
         (1 1)

         =========================================================================
         (1 2)
         (2 1)

         =========================================================================
         (1 3)
         (2 2)
         (3 1)

         =========================================================================
         (1 4)
         (2 3)
         (3 2)
         (4 1)

         =========================================================================
         (1 5)
         (2 4)
         (3 3)
         (4 2)
         (5 1)

         =========================================================================
         (1 6)
         (2 5)
         (3 4)
         (4 3)
         (5 2)
         (6 1)

         =========================================================================
         (1 7)
         (2 6)
         (3 5)
         (4 4)
         (5 3)
         (6 2)
         (7 1) |}]
  done
